$(document).ready ->

  checkMyLocation()
  removeText()
  #doCloseStationsMap()

removeText = () ->
  $('.textInput').focus ->
    $(@).val ""

checkMyLocation = () ->
  if $('#myLocationsMap').height() > 0
    navigator.geolocation.getCurrentPosition success, error, { timeout: 5000 }


success = (pos) -> 
  window.position = pos
  getAjax = () ->
    return $.ajax
      url: 'http://localhost:3000/close_stations.json'
      data: { coords: [pos.coords.latitude, pos.coords.longitude] }
      type: 'get'
  $.when(getAjax()).then populateMyLocation

populateMyLocation = (stations) ->
  latlng = new google.maps.LatLng position.coords.latitude, position.coords.longitude
  mapOptions = 
    center: latlng
    zoom: 14
    mapTypeId: google.maps.MapTypeId.ROADMAP
  map = new google.maps.Map(document.getElementById("myLocationsMap"),
    mapOptions);
  marker = new google.maps.Marker 
    map: map
    animation: google.maps.Animation.DROP
    position: latlng
  infoWindow = new google.maps.InfoWindow
    content: 'You are here'
  infoWindow.open map,marker



  
    
error = (error) ->
  alert 'Failed to get location' + JSON.stringify error

  



